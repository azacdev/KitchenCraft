import { SizeStringSchema } from "@/schema";
import { ImageResponse } from "@vercel/og";
import { NextRequest } from "next/server";
export const runtime = "edge";

// Image generation
export async function GET(
  _: NextRequest,
  { params }: { params: { size: string; index: number } }
) {
  const { width, height } = SizeStringSchema.parse(params.size);

  // Calculate the aspect ratio of the SVG and the container
  const svgAspectRatio = 1116 / 816;
  const containerAspectRatio = width / height;

  let svgWidth, svgHeight;
  const padding = 20; // Set the padding size

  // Adjust the SVG dimensions based on the container's aspect ratio and add padding
  if (svgAspectRatio > containerAspectRatio) {
    svgWidth = width - 2 * padding; // Subtract padding from both sides
    svgHeight = svgWidth / svgAspectRatio;
  } else {
    svgHeight = height - 2 * padding; // Subtract padding from top and bottom
    svgWidth = svgHeight * svgAspectRatio;
  }

  return new ImageResponse(
    (
      <div
        style={{
          width: `${width}px`,
          height: `${height}px`,
          display: "flex",
          flexDirection: "column",
          alignItems: "center",
          justifyContent: "center",
          padding: `${padding}px`, // Apply padding here
        }}
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          xmlSpace="preserve"
          style={{
            width: `${svgWidth}px`,
            height: `${svgHeight}px`,
            clipRule: "evenodd",
            strokeLinejoin: "round",
            strokeMiterlimit: 2,
            fill: "currentcolor",
          }}
          viewBox="0 0 1116 816"
        >
          <path
            d="M866.3 0h1.25c16.453.053 30.75 4.563 42.89 13.53 25.35 18.74 27.17 50.53 17.35 78.28a1025.307 1025.307 0 0 1-11.61 31.25l-.019.054a.628.628 0 0 0 .428.773l.051.013c32.75 6.89 56.31-13.45 74.6-37.68 14.37-19.04 29.22-40.39 46.07-56.15 20.35-19.027 44.83-28.563 73.46-28.61 10.99-.02 21.63.72 30.52 4.11 13.96 5.31 11.51 25.14-2.15 29.16-2.17.64-5.29.747-9.36.32-8.25-.853-13.76-1.267-16.53-1.24-34.64.3-56.26 19.02-75.95 45-19.43 25.62-38.63 55.44-68.43 70.11-.327.16-.377.38-.15.66 20.13 24.84 23.16 55.14 20.54 86.15-1.713 20.333-3.37 40.673-4.97 61.02-2.24 28.64-3.07 61.14 6.7 89.29 8.36 24.09 25.73 36.83 50.22 40.02 11.77 1.53 22.89.03 34.34-.36.33-.013.6-.15.8-.41 5.26-6.78 8.62-11.063 10.07-12.85 27.59-33.87 65.52-55.51 110.38-53.43 32.74 1.51 60.95 26.5 47.85 61.59-9.77 26.16-35.96 34.17-61.15 36.62-29.83 2.89-60.02.92-89.93.28a.798.798 0 0 0-.77.42c-17.76 29.99-29.05 64.87-35.94 98.85-7.56 37.22-10.77 86.08 24.12 112.06 22.42 16.69 52.85 14.69 76.27.6 28.89-17.38 46.33-45.42 55.09-77.22.09-.353-.01-.63-.32-.83-14.38-9.19-28.34-21.77-31.06-39.58-4.81-31.57 28.18-55.5 56.86-41.56 9.52 4.627 16.18 12.097 19.97 22.41 4.85 13.15 1.62 25.53-3.95 37.53-.21.447-.07.64.42.58 5.35-.653 10.45-1.937 15.32-3.85 3.94-1.547 6.63-2.353 8.07-2.42 10.03-.46 18.59 9.35 15.46 19.34a3194.083 3194.083 0 0 1-27.91 84.9c-1.97 5.73 1.02 8.69 6.66 7.78 16.57-2.67 30.64-21.7 38.21-35.24 4.54-8.12 9.11-21.39 14.79-30.67 25.39-41.47 77.32-81.26 128-55.88.34.173.59.083.76-.27 1.37-2.97 2.67-6.15 4.9-8.33 5.54-5.44 14.84-5.67 20.62-1.01 6.18 4.97 7.21 11.94 4.47 19.23-4.16 11.047-12.99 35.043-26.49 71.99-3.08 8.42-11.67 38.46 1.62 42.21 24.55 6.92 49.22-49.04 56.51-65.66 1.39-3.18 4-5.04 5.14-8.46 15.17-45.273 30.4-90.523 45.7-135.75 3.28-9.69 12.83-16.92 23.11-10.88 14.06 8.27 6.47 22.03 2.66 33.37-33.22 98.693-60.05 177.987-80.49 237.88-5.42 15.87-11.03 35.31-5.22 51.85 2.61 7.43 12.64.96 16.07-1.92 26.77-22.41 43.52-58.82 49.31-92.3 2.13-12.37 2.28-25.95-5.85-36.51a1.385 1.385 0 0 0-.83-.52c-9.43-1.99-15.24-10.27-12.58-19.89 2.11-7.64 8.66-10.81 16.33-11.18 37.31-1.83 71.88-15.31 98.63-41.42a9.006 9.006 0 0 0 2.3-3.71c4.11-12.513 8.15-25.06 12.12-37.64.11-.333-.02-.5-.37-.5-9.33-.03-15.82 1.34-25.71 3.66-3.91.92-6.84 1.217-8.77.89-16.97-2.84-17.35-25.65-1.54-30.85 14.68-4.833 30.08-6.58 46.2-5.24.35.027.58-.127.69-.46 5.39-16.853 10.82-33.697 16.28-50.53 1.51-4.64 2.99-7.873 4.46-9.7 6.01-7.47 16.41-7.59 23.22-1.09 4.52 4.307 5.64 10.043 3.37 17.21a6454.263 6454.263 0 0 0-14.92 47.55c-.09.313.02.497.34.55a78.559 78.559 0 0 0 21.11.37c20.81-2.42 26.31 26.86 4.12 31.13-11.07 2.13-23.47.86-34.58-.88a1.278 1.278 0 0 0-1.4.87 6539.57 6539.57 0 0 1-38.52 118.23c-4.12 12.25-1.52 20.06 12.76 20.76 29.58 1.43 49.3-34.49 59.63-56.77 1.86-4.007 3.54-6.747 5.05-8.22 9.96-9.71 26.99-2.35 26.44 11.5-.11 2.827-1.26 6.627-3.44 11.4-12.37 27.09-31.3 55.12-58.96 67.69-16.25 7.39-37.68 8.53-53.52-.52-18.96-10.83-25.86-32.59-18.85-52.89 2.51-7.28 4.94-14.593 7.29-21.94.11-.353.01-.443-.32-.27a187.13 187.13 0 0 1-51.51 18.39c-.4.08-.54.313-.42.7 14.19 46.1-11.07 104.7-40.57 139.85-12.23 14.58-28.63 27.78-48.26 29.31h-1.51c-26.99-1.43-37.65-25.77-37.11-49.51.49-21.32 6.71-40.7 13.7-60.57.01-.039.02-.08.02-.122 0-.203-.17-.37-.37-.37-.06 0-.12.015-.17.042-26.53 12.97-57.78 1.75-64.34-28.77-1.63-7.61-.86-14.39-.9-21.28v-.003a.37.37 0 0 0-.67-.217c-8.61 11.78-17.89 22.457-27.84 32.03-23.2 22.34-57.73 37.7-77.77.45a.412.412 0 0 0-.37-.218c-.11 0-.21.042-.29.118-15.34 15.05-40.05 27.82-61.6 16.32-16.44-8.77-22.07-27.58-16.34-45.24 4.45-13.727 10.69-32.287 18.72-55.68.1-.293-.01-.443-.32-.45l-10.81-.29c-.38-.013-.62.163-.73.53-10.16 36.4-32.09 70.19-63.84 91.18-37.35 24.69-86.09 25.5-121.18-3.95-30.94-25.97-39.94-66.35-36.19-105.06 4.27-44.073 16.08-86.02 35.41-125.84.2-.407.08-.58-.37-.52-9.7 1.3-18.49.15-29.31-1.73-74.05-12.82-79.39-94.51-75.08-152.84 1.767-23.867 3.613-47.73 5.54-71.59.49-6.02.95-12.12.55-17.88-1.97-28.14-20.83-60.26-52.64-60.65-.327-.007-.55.143-.67.45a187735.776 187735.776 0 0 1-76.13 201.56c-2.37 6.26-5.24 16.97-9.68 21.79-10.46 11.34-31.86 1.46-26.82-13.73 3.553-10.707 6.527-19.263 8.92-25.67 20.367-54.48 52.63-140.237 96.79-257.27 1.653-4.38 2.773-9.777 3.36-16.19 2.78-30.37-27.06-36.28-49.68-30.41-32.86 8.53-51.57 38.4-45.47 71.83.433 2.373 1.557 7.347 3.37 14.92 2.87 11.99-9.23 22.46-20.82 18.74-6.46-2.07-8.98-7-10.91-13.68-10.78-37.31-4.03-75.35 25.69-101.76C820.73 8.803 841.8.647 866.3 0Zm250.28 426.46c23.28.9 46.93 1.84 70.1-1.01 11.49-1.42 24.47-5.23 28.86-16.43 4.28-10.95-7.69-16.56-16.04-17.74-32.08-4.55-61.91 12.03-83.11 34.72-.27.293-.21.447.19.46Zm99.74 112.32c-10.33 6.96-.44 17.13 6.19 21.58.29.193.54.147.75-.14 3.25-4.533 4.84-9.603 4.79-15.21-.06-6.24-7.04-9.39-11.73-6.23Zm131.09 140.4c15.59 7.69 51.67-48.41 57.84-58.19 6.18-9.81 14.73-14.22 25.74-6.87.29.187.49.12.61-.2l10.57-28.42c.09-.267.02-.477-.22-.63-32.72-20.28-70.67 11.97-87.23 38.05-4.19 6.61-7.55 14.9-10.94 22.47-3.85 8.58-7.58 28.27 3.63 33.79Z"
            transform="translate(-772.579)"
          />
          <path
            d="M1888 183.82v4.24c-.93 26.94-8 52.28-18.8 76.75-5.41 12.28-10.8 23.49-18.05 33.6-8.88 12.39-20.89 28-36.31 37.56-13.44 8.33-35.96 17.44-51.19 8.56-18.71-10.91-11.25-39.32-6.34-55.47 6.37-20.91 15.1-41.53 23.58-61.99 1.59-3.83 3.88-12.68 1.71-16.32-5.2-8.73-25.99.18-32.64 4.02-6.35 3.67-12.6 6.79-15.5 12.9-.15.313-1.07 2.883-2.78 7.71a49992.44 49992.44 0 0 1-40.48 114.4c-3.22 9.07-12.37 12.75-21.15 9.55-5.56-2.03-11.53-10.35-9.49-16.37a4874.35 4874.35 0 0 0 7.81-23.21c.16-.487.03-.59-.4-.31-23.55 15.38-47.12 27.36-76.09 26.45-24.11-.75-43.23-11.16-53.82-33.73-.15-.333-.34-.353-.57-.06-14.75 19.28-35.26 33.92-60.27 34.06-33.42.18-55.46-26.57-44.21-59.53 6.33-18.547 12.62-37.103 18.89-55.67.63-1.86.94-4.01 1.36-6 1.47-7.02-5.34-11.99-11.85-12.69-16.67-1.8-30.86 10-40.38 22.5a44.958 44.958 0 0 0-6.38 11.6c-1.55 4.16-2.8 8.43-3.73 12.81-.6 2.83-2.15 4.62-3.02 7.18a93911.365 93911.365 0 0 0-33.88 100.35c-2.85 8.44-5.01 17.28-11.47 20.69-13.1 6.91-26.51-5.45-21.94-19.12 5.38-16.107 10.76-32.22 16.14-48.34.14-.413.03-.493-.33-.24-21.96 15.75-49.2 27.38-76.44 26.19-23.33-1.02-41.96-11.58-52.68-33.01-.17-.353-.38-.373-.62-.06-16.47 21.31-41.39 35.75-68.91 32.63-15.1-1.72-26.65-8.893-34.65-21.52-.19-.307-.42-.34-.69-.1-17.14 15.26-36.86 23.98-59.93 21.19-24.51-2.97-41.58-23.57-38.77-48.23.45-3.98 2.2-10.393 5.25-19.24 13.79-40.153 27.79-80.223 42.02-120.21.97-2.74 2.39-6.79 3.96-9.35 5.52-8.95 16.24-9.74 23.77-3.11 4.99 4.387 6.15 10.413 3.5 18.08a397220.04 397220.04 0 0 1-42.75 123.42c-3.03 8.75-9.26 22.13 3.33 26.63 4.1 1.467 8.92 1.643 14.45.53 24.6-4.94 39.88-31.39 49.86-51.7 2.4-4.873 4.82-11.07 7.27-18.59 7.69-23.593 15.31-47.217 22.84-70.87.11-.373-.02-.55-.41-.53-8.97.333-17.76 1.653-26.36 3.96-5.94 1.59-10.61 1.32-15.15-2.34-7.72-6.22-8.35-17.13-1.2-23.81 1.9-1.78 4.76-3.263 8.57-4.45 14.37-4.48 29.09-6.06 44.15-4.74.45.04.74-.153.87-.58 4.87-15.213 9.8-30.51 14.79-45.89 1.72-5.29 3.06-11.04 6.4-14.75 11.74-13.06 31.32-.48 26.16 16.2-4.96 16.027-9.96 32.03-14.99 48.01-.09.293.01.463.32.51 7.39 1.16 13.93 1.323 19.6.49 24.09-3.55 28.92 30.37.15 31.87-9.92.513-19.7-.093-29.35-1.82a.874.874 0 0 0-.98.6 6659.496 6659.496 0 0 1-38.64 118.6c-4.11 12.26-1.49 20.04 12.44 20.75 36.32 1.83 57.74-50.42 69.3-78.39 10.6-25.64 28.09-51.66 51.89-66.53 22.32-13.95 54.19-12.01 68.41 11.91 16.46 27.71-1.1 59.42-24.86 75.32-15.54 10.4-31.95-9.2-21.18-22.1 3.32-3.98 9.62-8.06 13.14-12.18 5.5-6.45 12.57-18.81 4.95-26.65-6.98-7.2-18.84-3.59-25.78 1.41-23.47 16.92-38.77 46.59-45.53 74.04-2.17 8.847-2.07 17.17.32 24.97 6.63 21.63 32.03 20.8 49.2 15.32 31.41-10.03 57.25-31.82 75.46-58.91 1.97-2.93 3.37-8.06 4.56-11.56l34.68-102.44c.13-.373-.01-.567-.4-.58-34.11-1.08-96.78-2.44-107.4-45.83-4.84-19.78 22.87-28.27 30.22-8.78 1.85 4.91 5.55 10.74 10.43 13.4 12.15 6.63 25.58 8.32 39.19 9.26a353.01 353.01 0 0 0 38.17.59.938.938 0 0 0 .86-.64c3.27-9.62 6.56-19.267 9.87-28.94 5.46-15.93 26.55-14.77 30.11 1.48.32 1.44.21 3.01-.34 4.71-2.18 6.82-4.34 13.64-6.47 20.46-.11.353.01.513.38.48 59.22-5.3 118-13.74 176.9-21.67 39.39-5.31 79.26-9.5 119-10.91 18.73-.66 37.02.493 54.89 3.46 50.65 8.41 88.58 40.36 93.51 94.09.44 4.827.75 9.683.92 14.57Zm-146.72-7.77c1.8 1.48 3.37 3.9 4.64 5.92.2.322.63.429.95.24 11.12-6.21 24.05-8.25 36.62-8.26 25.55-.03 38.87 16.64 33.81 41.62-1.83 9.08-5.06 18.957-9.68 29.63a669.85 669.85 0 0 0-17.75 45.59c-1.7 4.89-7.31 21.74-1.44 24.69 3.78 1.9 12.6-4.19 15.58-6.98 4.87-4.57 9.26-9.41 13.04-15.17 14.69-22.413 25.78-46.467 33.28-72.16 5.71-19.56 7.9-41.29 2.92-61.16-15.91-63.43-97.55-58.38-145.68-54.38-38.48 3.2-76.84 7.473-115.08 12.82-59.18 8.28-106.89 14.85-160.64 18.39a.62.62 0 0 0-.54.42l-15.72 46.8c-.15.46 0 .613.46.46 11.64-3.933 22.95-4.777 33.94-2.53 22.22 4.54 36.44 23.68 34.64 46.21-.28 3.54-1.5 8.44-3.65 14.7a3185.26 3185.26 0 0 0-18.88 56.57c-2.09 6.47.14 11.77 6.68 14.18 7.3 2.7 15.15 1.35 22.01-1.7 23.42-10.41 40.52-46.63 49.81-68.85 10.22-24.43 22.98-47.03 43.22-64.77 17.27-15.13 40.49-23.49 62.57-12.92 14.58 6.98 23.38 20.96 24.22 37.01 1.99 37.63-38.47 62.44-68.05 74.61-13 5.347-25.84 7.913-38.53 7.7-.28-.007-.42.13-.41.41.74 30.97 28.47 33.53 51.69 26.42 30.92-9.46 58.5-34.17 75.91-60.84 1.63-2.493 2.99-5.31 4.09-8.45 6.81-19.48 13.65-38.95 20.54-58.41 4.01-11.34 16.28-15.37 25.43-7.81Zm-106.63 18.53c-14.16-9.5-32.4 7.62-40.8 18.01-9.83 12.153-17.57 25.527-23.24 40.12-.15.387-.02.56.4.52 21.74-2.27 53.05-19.08 64.83-37.6 4.1-6.44 5.72-16.41-1.19-21.05Z"
            transform="translate(-772.579)"
          />
          <path
            d="M1074.66 94.42c4.54-10.45 18.55-10.61 25.52-3.37 5.17 5.36 4.7 11.59 2.13 18.6-2.03 5.53-5.36 15.52-10.26 18.88-11.86 8.12-27.87-3.54-23.83-17.54.99-3.453 3.14-8.977 6.44-16.57Z"
            transform="translate(-772.579)"
          />
        </svg>
      </div>
    ),
    {
      width,
      height,
    }
  );
}
